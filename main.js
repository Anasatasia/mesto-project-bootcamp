(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{YS:()=>B,hV:()=>J,_u:()=>C,vV:()=>T,Gj:()=>U,Gy:()=>j,Md:()=>d,Px:()=>x,tb:()=>E,wC:()=>A,f:()=>P,BU:()=>q,NT:()=>b,lx:()=>m,rC:()=>S,Ph:()=>v,Ng:()=>h,Xd:()=>M});var t=function(e){e.classList.add("popup_opened"),document.addEventListener("keydown",l)},n=function(e){document.removeEventListener("keydown",l),e.classList.remove("popup_opened")};function r(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}var o={baseUrl:"https://nomoreparties.co/v1/exp-mipt-fbc-1",headers:{authorization:"e2b74456-ec21-4848-ac9c-a11ddea4417d","Content-Type":"application/json"}};function c(e,n,c,a,u){var l=d.querySelector("#card-template").content.querySelector(".card").cloneNode(!0),s=l.querySelector(".card__image"),p=l.querySelector(".card__like-number"),f=l.querySelector(".card__button"),_=l.querySelector(".card__delete-button");return p.textContent=c.length,l.querySelector(".card__name").textContent=e,s.src=n,s.alt=e,c.forEach((function(e){e._id===i&&f.classList.add("card__button_active")})),u._id!==i&&_.classList.add("card__delete-button_inactive"),f.addEventListener("click",(function(e){!function(e,t,n,c){e.target.classList.contains("card__button_active")?function(e){return fetch(o.baseUrl+"/cards/likes/"+e,{method:"DELETE",headers:o.headers}).then(r)}(t).then((function(e){c.textContent=e.likes.length})).then((function(){e.target.classList.remove("card__button_active")})).catch(console.error):function(e){return fetch(o.baseUrl+"/cards/likes/"+e,{method:"PUT",headers:o.headers}).then(r)}(t).then((function(e){c.textContent=e.likes.length})).then((function(){e.target.classList.add("card__button_active")})).catch(console.error)}(e,a,0,p)})),u._id===i&&_.addEventListener("click",(function(e){(function(e){return fetch(o.baseUrl+"/cards/"+e,{method:"DELETE",headers:o.headers}).then(r)})(a).then((function(){l.remove()})).catch(console.error)})),s.addEventListener("click",(function(r){U.src=n,j.textContent=e,U.alt=e,t(T)})),l}function a(e,t,n,r,o){var a=c(e,t,n,r,o);C.prepend(a)}function u(e,t,n){!function(e){var t=1;return e.forEach((function(e){e.validity.valid||(t=0)})),1!==t}(t)?(e.classList.remove(n.inactiveButtonClass),e.removeAttribute("disabled")):(e.classList.add(n.inactiveButtonClass),e.setAttribute("disabled","disabled"))}var i="";function l(e){if("Escape"===e.key){var t=document.querySelector(".popup_opened");null!==t&&n(t)}}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,c,a,u=[],i=!0,l=!1;try{if(c=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=c.call(n)).done)&&(u.push(r.value),u.length!==t);i=!0);}catch(e){l=!0,o=e}finally{try{if(!i&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return u}}(e,t)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var d=document.querySelector(".page"),f=d.querySelector(".profile__edit-button"),_=d.querySelector("#profile-popup-form"),v=d.querySelector("#profile-popup"),h=v.querySelector(".popup__button"),y=v.querySelector(".popup__close-button"),m=v.querySelector("#profile_popup_name"),b=v.querySelector("#profile_popup_description"),S=d.querySelector(".profile__name"),q=d.querySelector(".profile__description"),C=d.querySelector(".cards"),E=d.querySelector("#place-popup"),L=E.querySelector(".popup__close-button"),g=d.querySelector(".profile__add-button"),k=E.querySelector(".popup__form"),x=E.querySelectorAll(".popup__input"),A=E.querySelector(".popup__button"),T=d.querySelector(".popup-image"),U=T.querySelector(".popup-image__image"),j=T.querySelector(".popup-image__title"),O=T.querySelector(".popup__close-button"),w=d.querySelectorAll(".popup"),P=d.querySelector(".profile__avatar"),B=d.querySelector("#avatar-popup"),N=d.querySelector(".profile__avatar-button"),D=B.querySelector(".popup__close-button"),I=B.querySelector(".popup__form"),J=B.querySelector(".popup__button"),M={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_invalid",inputErrorClass:"popup__input_invalid",errorClass:"popup__input-error_invalid"};f.addEventListener("click",(function(e){b.value=S.textContent,m.value=q.textContent,t(v)})),N.addEventListener("click",(function(e){t(B)})),g.addEventListener("click",(function(e){t(E)})),y.addEventListener("click",(function(e){n(v)})),O.addEventListener("click",(function(e){n(T)})),L.addEventListener("click",(function(e){n(E)})),D.addEventListener("click",(function(e){n(B)})),k.addEventListener("submit",(function(e){e.preventDefault();var t,c,i=e.currentTarget.elements,l=i.place_popup_name,s=i.place_popup_link;A.textContent="Создание...",(t=l.value,c=s.value,fetch(o.baseUrl+"/cards",{method:"POST",headers:o.headers,body:JSON.stringify({name:t,link:c})}).then(r)).then((function(e){a(e.name,e.link,e.likes,e._id,e.owner)})).then((function(){l.value="",s.value=""})).then((function(){u(A,x,M)})).then((function(){n(E)})).catch(console.error).finally((function(){A.textContent="Создать"}))})),_.addEventListener("submit",(function(e){e.preventDefault();var t,c,a=e.currentTarget.elements,u=a.profile_popup_name,i=a.profile_popup_description;h.textContent="Сохранение...",(t=u.value,c=i.value,fetch(o.baseUrl+"/users/me",{method:"PATCH",headers:o.headers,body:JSON.stringify({name:t,about:c})}).then(r)).then((function(e){S.textContent=e.name,q.textContent=e.about})).then((function(){return n(v)})).catch(console.error).finally((function(){h.textContent="Сохранить"}))})),I.addEventListener("submit",(function(e){e.preventDefault();var t,c=e.currentTarget.elements.avatar_popup_link;J.textContent="Сохранение...",(t=c.value,fetch(o.baseUrl+"/users/me/avatar",{method:"PATCH",headers:o.headers,body:JSON.stringify({avatar:t})}).then(r)).then((function(e){P.src=e.avatar})).then((function(){return n(B)})).catch(console.error).finally((function(){J.textContent="Сохранить"}))})),function(e){d.querySelectorAll(e.formSelector).forEach((function(t){!function(e,t){var n=e.querySelectorAll(t.inputSelector),r=e.querySelector(t.submitButtonSelector);u(r,n,t),n.forEach((function(o){o.addEventListener("input",(function(c){!function(e,t,n){e.validity.valid?function(e,t,n){e.classList.remove(n.inputErrorClass);var r=t.querySelector("#".concat(e.id,"-error"));r.textContent="",r.classList.remove(n.errorClass)}(e,t,n):function(e,t,n,r){e.classList.add(r.inputErrorClass);var o=t.querySelector("#".concat(e.id,"-error"));o.textContent=n,o.classList.add(r.errorClass)}(e,t,e.validationMessage,n)}(o,e,t),u(r,n,t)}))}))}(t,e)}))}(M),w.forEach((function(e){!function(e){e.addEventListener("click",(function(t){t.target===t.currentTarget&&n(e)}))}(e)})),Promise.all([fetch(o.baseUrl+"/users/me",{headers:o.headers}).then(r),fetch(o.baseUrl+"/cards",{headers:o.headers}).then(r)]).then((function(e){var t,n;return(n=s(t=e,2))[0],n[1],t})).then((function(e){var t,n,r,o,c=s(e,2),u=c[0],l=c[1];t=u.name,n=u.about,r=u.avatar,o=u._id,S.textContent=t,q.textContent=n,P.src=r,i=o,function(e){console.log(e),e.forEach((function(e){a(e.name,e.link,e.likes,e._id,e.owner)}))}(l)})).catch(console.error)})();